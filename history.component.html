<div class="history-page">
  <h2>COLD ROLLING MILL PASS SCHEDULE SUMMARY</h2>
<img src="assets/ethal-logo.png" alt="Ethal Logo" class="page-watermark">
  <div class="history-controls">
    <input type="text" [(ngModel)]="searchTerm" placeholder="Search by Supervisor or Date">
    <button (click)="exportToExcel()">üìÅ Export to Excel</button>
  </div>

  <div class="table-container">
    <table>
      <thead>
        <tr>
          <th rowspan="2">Date</th>
          <th rowspan="2">SUPERVISOR</th>
          <th rowspan="2">CRM</th>
          <th rowspan="2">INGOT</th>
          <th colspan="2">CIRCLE</th>
          <th colspan="3">HOT SHEARED SHEET</th>
          <th colspan="15">PASS SCHEDULE (mm)</th>
        </tr>
        <tr>
          <th>Dia</th>
          <th>Thi</th>
          <th>W</th>
          <th>L</th>
          <th>Th.</th>
          <th *ngFor="let i of [].constructor(15); let p = index">P-{{p+1}}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let row of filteredData()">
          <td>{{ row?.date | date: 'dd / MMM / yyyy' }}</td>
          <td>{{ row?.supervisor }}</td>
          <td>{{ row?.crm }}</td>
          <td>{{ row?.ingot }}</td>
          <td>{{ row?.circleDia }}</td>
          <td>{{ row?.circleTh }}</td>
          <td>{{ row?.sheetW }}</td>
          <td>{{ row?.sheetL }}</td>
          <td>{{ row?.sheetTh }}</td>
          <td *ngFor="let val of row?.passes">{{ val }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>